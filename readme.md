# 🚀 Kubernetes에서 MinIO를 활용한 AWS S3 대체

## **나의 상황**

프로필 사진과 PDF 파일을 저장해야 하는데 기존 **NFS(Network File System) 방식이 불편**했다.
처음에는 NFS를 사용해 파일을 저장했지만, 여러 문제가 발생했다:

- **확장성 문제**: 파일이 많아질수록 성능이 저하되었고, 다중 노드 환경에서 동기화 문제가 발생했다.
- **접근 속도**: 특정 파일을 로드하는 시간이 길어졌으며, 특히 대용량 파일의 경우 더욱 심각했다.
- **URL 접근 불가**: 웹에서 이미지나 PDF를 직접 조회하려면 별도의 웹 서버 설정이 필요해 관리가 어려웠다.

이러한 문제를 해결하기 위해 **Object Storage 방식의 MinIO**를 도입하기로 했다.

---

## **1️⃣ Object Storage를 사용하는 이유**

프로필 이미지, PDF 같은 파일을 저장할 때, **Object Storage**가 가장 적합한 이유는 다음과 같습니다.

### **📌 1.1 파일 저장 방식의 차이**

| 스토리지 유형            | 특징                  | 장점                     | 단점            |
| ------------------ | ------------------- | ---------------------- | ------------- |
| **File Storage**   | 계층적(디렉토리 기반) 파일 시스템 | 사용이 직관적                | 성능 확장성이 낮음    |
| **Block Storage**  | 디스크처럼 블록 단위 저장      | 고성능, 데이터베이스에 적합        | 파일 관리가 어려움    |
| **Object Storage** | 키-값 기반 객체 저장        | 무제한 확장 가능, 메타데이터 저장 가능 | 지연 시간이 길 수 있음 |

### **📌 1.2 Object Storage의 장점**

- **무제한 확장 가능** → 파일 개수가 많아져도 성능 저하 없음
- **URL을 통한 파일 접근 가능** → 이미지, PDF 등을 웹에서 직접 로드 가능
- **메타데이터 저장 가능** → 파일과 관련된 추가 정보를 저장할 수 있음
- **비용 효율적** → 스토리지를 효율적으로 관리할 수 있어 비용 절감 가능

👉 **결론**: 프로필 이미지, PDF 같은 정적인 파일을 저장할 때 **Object Storage가 가장 적합!**\
👉 **특히, AWS S3와 같은 클라우드 스토리지와 100% 호환되는 MinIO를 활용하면 더욱 강력한 기능을 제공 가능!**

---

## **2️⃣ Kubernetes에서 MinIO를 활용하여 AWS S3 대체하기**

### **📌 2.1 MinIO란?**

- **MinIO는 AWS S3와 100% 호환되는 오픈소스 객체 스토리지**
- **쿠버네티스(Kubernetes) 환경에서도 운영 가능**
- **AWS 없이도 S3 API를 사용할 수 있어 비용 절감 가능**

### 📌 2.2 Kubernetes에서 MinIO를 활용하면 좋은 점

| 항목            | MinIO                | AWS S3              |
| ------------- | -------------------- | ------------------- |
| **배포 환경**     | 온프레미스, 클라우드 어디서나 가능  | AWS에서만 사용 가능        |
| **S3 API 지원** | 100% 호환              | 기본 제공               |
| **비용**        | 서버 운영 비용만 필요 (저렴)    | 사용량에 따라 비용 증가       |
| **속도**        | 로컬 네트워크에서 빠름         | 인터넷 대역폭에 따라 속도 달라짐  |
| **데이터 보안**    | 자체 서버 운영으로 데이터 보호 가능 | AWS 정책에 따라 보안 설정 필요 |

👉 **결론**:\
**MinIO를 Kubernetes에 배포하면, AWS S3 없이도 자체적으로 오브젝트 스토리지를 운영할 수 있음**\
✅ 비용 절감\
✅ 자체 데이터 관리 가능\
✅ 쿠버네티스 환경과 완벽하게 통합

---

**Spring Boot와 MinIO 연동 (S3 API 사용)**

- MinIO를 활용하면 AWS S3 API 그대로 사용 가능

```java
@Value("${minio.url}")
private String minioUrl;
@Value("${minio.access-key}")
private String accessKey;
@Value("${minio.secret-key}")
private String secretKey;
```

---

## **✅ 결론**

\
✔ **비용 절감** – AWS S3 사용료 없이 운영 가능\
✔ **유연성** – 온프레미스 & 클라우드 모두 지원\
✔ **빠른 속도** – 로컬 네트워크에서 고속 데이터 접근 가능\
✔ **S3 API 완벽 호환** – 기존 S3 API 사용 그대로 유지 가능



